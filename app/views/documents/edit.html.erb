<% @page_specific_scripts_js = ["parser", "vendors/prototip/prototip", "vendors/lightview/js/lightview.js", "vendors/modal.js"] %>
<% @page_specific_scripts_css = ["prototip/prototip", "/javascripts/vendors/lightview/css/lightview"] %>

<div id="doc_options" class="doc_options loading">
  <span>Class: <%= select 'tag', 'id', current_user.tags.collect {|t| [ t.name, t.id ] } %> Title: <input id="document_name" value="<%=@document.name%>"></input></span>
  <button id="review_button" style="float:right">Review</button>
  <button id="share_button" style="float:right;">Share</button>
  <button id="save_button" style="float:right;" class="saving">Saved</button>
</div>

<div id="editor_container">
  <textarea id="editor" name="editor" style="display:none"><%=@document.html%></textarea>
</div>

<div id="right_rail" class="" style="display:none">
  <table class="align_bottom" valign="bottom"><tr><td id="cards" valign="bottom">
    <!--<div class="card card_active rounded_border"><input type="checkbox" class="card_activation" />truncated test</div>
    <div class="card_focus card rounded_border">
      <input type="checkbox" class="card_activation" />
      <div class="card_front">front</div>
      <div class="card_back">back and probablyaf sfkljasldk jfasldjfl;aksdjflsjdfsj flsjf lsk</div>
    </div>-->
  </td></tr></table>
</div>

<!-- document vars -->
<div id="document_id" style="display:none;"><%=@document.id%></div>
<div id="line_ids" style="display:none;"><%=@line_ids%></div>
<div id="new_doc" style="display:none;"><%=@new_doc%></div>
<div id="doc_count" style="display:none;"><%=@doc_count%></div>

<%= javascript_include_tag ["vendors/tiny_mce/tiny_mce"], :cache => false %>
<script type="text/javascript">
tinyMCE.init({
  mode : "textareas",
  theme : "advanced",
  skin:"thebigreason",
  plugins : "spellchecker,insertdatetime,print,lists,inlinepopups",

  // Theme options - button# indicated the row# only
  theme_advanced_buttons1 : "print,spellchecker,undo,redo,fontselect,fontsizeselect,forecolor,backcolor,|,bold,italic,underline,|,justifyleft,justifycenter,justifyright,|,bullist,numlist,outdent,indent,|,charmap",
  <%#*theme_advanced_buttons1 : "print,spellchecker,undo,redo,fontselect,fontsizeselect,forecolor,backcolor,|,bold,italic,underline,|,justifyleft,justifycenter,justifyright,|,bullist,numlist,outdent,indent,|,image,charmap",%>
  theme_advanced_buttons2 : "",
  theme_advanced_buttons3 : "",
  theme_advanced_toolbar_location : "top",
  theme_advanced_toolbar_align : "left",
  theme_advanced_resizing : true,

  // Drop lists for link/image/media/template dialogs
  template_external_list_url : "/javasripts/vendors/tinymce/template_list.js",
  external_link_list_url : "/javasripts/vendors/tinymce/link_list.js",
  external_image_list_url : "/javasripts/vendors/tinymce/image_list.js",
  media_external_list_url : "/javasripts/vendors/tinymce/media_list.js",

  content_css : "/stylesheets/documents/edit_contents.css",

  onpageload : function() {doc.onEditorLoaded()},

  setup : function(ed) {
    ed.onKeyDown.add(function(ed, e) {
        doc.outline.onChange(ed.selection.getNode(), e);
    });
    ed.onBeforeExecCommand.add(function(ed) {
        console.log("yoooo!");
        doc.outline.onChange(ed.selection.getNode());
    });
  }
});
</script>

<div id="tip_elements" style="display:none">
  <div id="tip_title">
      <div class="circle"><div class="circumscribed">1</div></div><div class="instruction">Title your document</div>
      <a onClick="doc.tipTour.showEditor();" href="javascript:void(0)">Next</a>
  </div>
  <div id="tip_editor">
      <div class="circle"><div class="circumscribed">2</div></div><div class="instruction">Take notes here</div>
      <a onClick="doc.tipTour.showCards();" href="javascript:void(0)">Next</a>
  </div>
  <div id="tip_cards">
      <div class="circle"><div class="circumscribed">3</div></div><div class="instruction">Cards will appear here when you use a dash like:<p>Zendo - meditation hall</p></div>
      <a onClick="doc.tipTour.showReview();" href="javascript:void(0)">Next</a>
  </div>
  <div id="tip_review">
      <div class="circle"><div class="circumscribed">4</div></div><div class="instruction">Review here</div>
      <a onClick="doc.tipTour.restartTour();" href="javascript:void(0)">Restart</a>
  </div>
</div>

<button id="panel_button" class="display-options" style="float:right; margin-top:6px; background: #bbb; border-color:#999; color:#333;">Side Panel</button>
<button id="full_window_button" class="display-options" style="float:right; margin-top:6px;">Full Window</button>

<div id="share_menu" style="display:none;">
  <div class="title">
    Sharing
  </div>
  <div class="content">
    <div>
      <span class="option">Public/Private:</span>
      <%= select 'document', 'name', [['public',true],['private',false]] %>
    </div>
    <div class="user-tokens">
      <span class="option" style="float:left; padding: 2px 2px 2px 0; margin: 2px 2px 2px 0;">Sharing with:</span>
      <span class="token">
        josh.silverman@gmail.com
        <span class="remove" >X</span>
      </span>
      <span class="token">
        bill.derusha@gmail.com
        <span class="remove" >X</span>
      </span>
      <span class="token">
        jason.urton@gmail.com
        <span class="remove" >X</span>
      </span>
    </div>
    <div class="clr-thin"></div>
    <div>
      <span class="option">Add a person:</span>
      <%= form_tag "temp", :method => "post" do %>
        <%= text_field_tag :name %>
        <%= submit_tag "Share" %>
      <% end %>
    </div>
  </div>
</div>